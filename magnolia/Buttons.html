<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Buttons | Learning arduino with the Magnolia</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="raspofabs">
        <meta name="description" content="This gitbook is a guide for beginners who have their hands on a Magnolia board from the L.A. Robotics club, originally developed as a Kickstarter campaign to produce an Arduino inspired robotics starter kit for a very meagre sum of $5 per board.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="./Serial output.html" />
        
        
        <link rel="prev" href="./Multiple lights.html" />
        

        <meta property="og:title" content="Buttons | Learning arduino with the Magnolia">
        <meta property="og:site_name" content="Learning arduino with the Magnolia">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/raspofabs">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="raspofabs/magnoliabook" data-level="4" data-basepath="." data-revision="1398625535799">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/raspofabs/magnoliabook" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/raspofabs/magnoliabook/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/raspofabs/magnoliabook/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="./" >Learning arduino with the Magnolia</a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/raspofabs" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/raspofabs/magnoliabook/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/raspofabs/magnoliabook/edit/master/Buttons.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="Software requirements.html">
                
                <a href="./Software requirements.html">
                    <i class="fa fa-check"></i> <b>1.</b> Basic requirements
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="First steps.html">
                
                <a href="./First steps.html">
                    <i class="fa fa-check"></i> <b>2.</b> First steps
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="Multiple lights.html">
                
                <a href="./Multiple lights.html">
                    <i class="fa fa-check"></i> <b>3.</b> Multiple lights
                </a>
                
                
            </li>
        
            <li  data-level="4" data-path="Buttons.html">
                
                <a href="./Buttons.html">
                    <i class="fa fa-check"></i> <b>4.</b> Buttons
                </a>
                
                
            </li>
        
            <li  data-level="5" data-path="Serial output.html">
                
                <a href="./Serial output.html">
                    <i class="fa fa-check"></i> <b>5.</b> Serial output
                </a>
                
                
            </li>
        
            <li  data-level="6" data-path="Serial input.html">
                
                <a href="./Serial input.html">
                    <i class="fa fa-check"></i> <b>6.</b> Serial input
                </a>
                
                
            </li>
        
            <li  data-level="7" data-path="Analogue Input.html">
                
                <a href="./Analogue Input.html">
                    <i class="fa fa-check"></i> <b>7.</b> Analogue Input
                </a>
                
                
            </li>
        
            <li  data-level="8" data-path="Filesystem.html">
                
                <a href="./Filesystem.html">
                    <i class="fa fa-check"></i> <b>8.</b> Filesystem
                </a>
                
                
            </li>
        
            <li  data-level="9" >
                
                <span><b>9.</b> Shift Registers</span>
                
                
            </li>
        
            <li  data-level="10" >
                
                <span><b>10.</b> Servos</span>
                
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 50%;min-width: 37.5%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./Software requirements.html" title="Basic requirements" class="chapter done new-chapter" data-progress="1" style="left: 12.5%;"></a>
    
        <a href="./First steps.html" title="First steps" class="chapter done new-chapter" data-progress="2" style="left: 25%;"></a>
    
        <a href="./Multiple lights.html" title="Multiple lights" class="chapter done new-chapter" data-progress="3" style="left: 37.5%;"></a>
    
        <a href="./Buttons.html" title="Buttons" class="chapter done new-chapter" data-progress="4" style="left: 50%;"></a>
    
        <a href="./Serial output.html" title="Serial output" class="chapter  new-chapter" data-progress="5" style="left: 62.5%;"></a>
    
        <a href="./Serial input.html" title="Serial input" class="chapter  new-chapter" data-progress="6" style="left: 75%;"></a>
    
        <a href="./Analogue Input.html" title="Analogue Input" class="chapter  new-chapter" data-progress="7" style="left: 87.5%;"></a>
    
        <a href="./Filesystem.html" title="Filesystem" class="chapter  new-chapter" data-progress="8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_2">
                    
                        <h1 id="buttons">Buttons</h1>
<p>To make interactive things, you need inputs. The most basic of which is a simple push button. This lesson shows you how to add a button, read its value, and react to it. In addition, we&#39;re going to learn an important lesson about circuits.</p>
<h2 id="the-code">The code</h2>
<p>Firstly, we again start with the modified blink sketch. We will modify the first section:</p>
<pre><code>int led = A0;
int button = A1;
</code></pre><p>We don&#39;t really need to modify the <code>setup()</code> section, as Arduino sets all pins to <code>INPUT</code> by default, but if it didn&#39;t we would do this:</p>
<pre><code>pinMode(led, OUTPUT);
pinMode(button, INPUT);
</code></pre><p>Then we will modify <code>loop()</code> to react to our button press:</p>
<pre><code>if( digitalRead(button) )
{
    digitalWrite(led, HIGH);
}
else
{
    digitalWrite(led, LOW);
}
</code></pre><p><code>if( ... )</code> is a keyword that tells the processor that it should do the thing following if the value is not zero, else do the thing in the else. In this case, the <code>digitalRead</code> makes the processor set the led to on or off based on the value of the pin <code>button</code>.</p>
<h2 id="wiring">Wiring</h2>
<p>You now need to wire up your Magnolia so the button is connected to <strong>A1</strong>. To do this, you will need to put your switch on a prototype board, and connect jumper wires from the <strong>VCC</strong> and <strong>A1</strong> to the two legs of the switch.</p>
<p>Buttons with only two pins need to be put in so that the legs are not on the same row (rows are already connected inside the prototyping board). Buttons with four or five pins have connected pairs of legs (five pin buttons have a dead leg that is meant for stability). Find out which pairs of legs are already connected by using the switch in the board and power an LED.</p>
<p>First put the button onto the prototyping board, designate one side of the button <strong>B0</strong> and the other <strong>B1</strong>.</p>
<ul>
<li>Make a connection between <strong>VCC</strong> and <strong>B0</strong> (using a jumper from the Magnolia to the row in which <strong>B0</strong> resides.)</li>
<li>Make a connection between <strong>A1</strong> and <strong>B1</strong> (again using a jumper from the Magnolia to the row in whch <strong>B1</strong> resides.)</li>
</ul>
<h2 id="uploading-and-seeing-something-strange">Uploading and seeing something strange</h2>
<p>When you upload the program, you will notice that the LED turns on before you touch the button. Sometimes it will flicker on and off a few times, but if you press the button, the LED will stay on constantly. This is because the switch connects the <strong>VCC</strong> to <strong>A1</strong> when the button is pressed, but there is nothing connected to <strong>A1</strong> when the button is not pressed.</p>
<p>In this detached state, reading values from <strong>A1</strong> is very nearly random. Sometimes the voltage goes high just because moving your hand near the button increases the capacitance of the wire. Try playing with it for a bit before we fix the problem.</p>
<h2 id="fixing-a-floating-input">Fixing a floating input</h2>
<p>Try moving the jumper from <strong>B1</strong>, to <strong>GND</strong>. Doing this makes the LED stay turned off. This is because the input <strong>A1</strong> is getting a strong grounding signal. The grounding signal doesn&#39;t have to be very strong, but it has to be there otherwise the wire acts like a kind of aerial or capacitor, picking up stray charge and triggering the <strong>A1</strong> seemingly at random.</p>
<p>When you want a wire to register a high when a button is pressed, you need to connect <strong>B0</strong> to the <strong>VCC</strong>, and <strong>B1</strong> to <strong>A1</strong>, but to make a wire register a low, you also need to connect <strong>A1</strong> to the <strong>GND</strong> so that when the button isn&#39;t pressed, the <strong>A1</strong> pin is <em>dragged down</em> towards <strong>GND</strong>.</p>
<p>If we connected the output side of the button to <strong>GND</strong> the LED would stay off while the button wasn&#39;t pressed, but as soon as we pressed the button, it would short the whole thing out and we may even break stuff.</p>
<p>The solution is to make the <strong>GND</strong> connected to the output side of the button, but in such a way that it doesn&#39;t matter if we press the button. We don&#39;t have to be strongly grounded, so we can make that connection weaker. To do this, we add a rather high valued resistor. Usually, anything over 2000 Ohms will do, I prefer 470kOhm just to be sure I&#39;m not wasting juice on the <em>pulldown resistor</em>.</p>
<p>Wire up the circuit <strong>VCC</strong> to button in, button out to <strong>A1</strong>, but also button out, via <em>pulldown resistor</em> to <strong>GND</strong>. Place your resistor on the prototyping board, and like with the button give the two legs names <strong>R0</strong> and <strong>R1</strong>.</p>
<ul>
<li>Make a connection between <strong>VCC</strong> and <strong>B0</strong></li>
<li>Make a connection between <strong>A1</strong> and <strong>B1</strong></li>
<li>Make a connection between <strong>B1</strong> and <strong>R0</strong></li>
<li>Make a connection between <strong>R1</strong> and <strong>GND</strong></li>
</ul>
<p><img src="button_circuit.png" alt="button"></p>
<p>Now, when you run the program, the LED does not turn on and off randomly.</p>
<h2 id="what-we-need-to-learn-from-this">What we need to learn from this</h2>
<p>Using switches can cause gaps in your circuits, so you need to make sure you have a circuit all the time, no dangling wires that go no-where. There are two ways to fix dangling wires on switches, the first is to use a <code>pulldown resistor</code>, like we did above. Doing this means that at no point is the input pin left unconnectd.</p>
<p>The second method is to use the other input mode of the chip, namely <code>INPUT_PULLUP</code>. In this mode things are a bit backward, you will want to connect the switch between the <code>INPUT_PULLUP</code> pin, and the <strong>GND</strong>. When the button is pressed, the button will drain causing a change in state for <code>digitalRead( ... )</code> on the input pin.</p>
<h2 id="finally">Finally</h2>
<p>Like with the limited resources stopping us from having more LEDs, you&#39;ll find that the Magnolia having only 6 IO ports makes having more than 6 buttons a very difficult thing. We can solve this problem too, but that will come in a later lesson about shift-in registers. These convert parallel data into serial data, meaning you can read from 8 inputs at once, using only three pins, just like you did with the shift register for extending the number of outputs.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./Multiple lights.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./Serial output.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
